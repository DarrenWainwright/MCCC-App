@page "/door"

@using MCCC_App.Data
@inject IIOTHub iotHubService


@if (deviceState.ToLower() == "disconnected")
{
    <div class="alert alert-danger" role="alert">
    Oh man, the coop isn't online...
</div>

}
else
{

    <div class="d-flex justify-content-center">
        <DoorButton CurrentState=@doorState />
    </div>

    <div class="card">
        <div class="card-body">
            <blockquote class="blockquote mb-0">
                <p>“Be an opener of doors”</p>
                <footer class="blockquote-footer"> Ralph Waldo Emerson</footer>
            </blockquote>
        </div>
    </div>
}

@code {
    private string deviceState = "--checking--";
    private string doorState = "Closed";

    protected override async Task OnInitializedAsync()
    {
        try
        {
            deviceState = await iotHubService.DeviceState("MCCC");
            doorState = await iotHubService.DoorState("MCCC");
        }
        catch (System.Exception)
        {
            // do nothing right now...
        }

    }
}
